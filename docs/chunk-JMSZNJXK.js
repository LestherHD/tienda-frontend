import{a as H,b as K}from"./chunk-VXC2LIA7.js";import{b as Q}from"./chunk-KE34UVXE.js";import{b as N,c as k,f as B,h as L,k as U,l as q,m as R,o as $,p as J,q as G}from"./chunk-HYY5DU64.js";import{$a as A,A as O,B as l,C as p,Ca as I,Ea as D,J as m,M as d,Pa as F,T as i,U as e,V as g,W as v,Xa as j,Y as C,Ya as V,Z as u,_ as M,_a as T,ea as n,fa as f,ga as P,la as w,m as S,r as _,s as x,t as b,ta as y,ua as z,wa as E}from"./chunk-YUHIDNIN.js";import"./chunk-Z6EQZUNN.js";function W(a,s){if(a&1&&(i(0,"option",39),n(1),e()),a&2){let o=s.$implicit;M("value",o),l(),f(o)}}function X(a,s){if(a&1){let o=v();i(0,"div")(1,"div",12)(2,"label",13),n(3),e(),i(4,"div",36)(5,"select",37),C("change",function(t){let c=_(o).$implicit,h=u(3);return x(h.onSeleccionarValorCaracteristica(c.nombre,t,null))}),m(6,W,2,2,"option",38),e()()()()}if(a&2){let o=s.$implicit;l(3),P("",o.nombre,": "),l(3),d("ngForOf",o.listaValores)}}function Y(a,s){if(a&1&&(i(0,"div"),m(1,X,7,2,"div",35),e()),a&2){let o=u(2);l(),d("ngForOf",o.filteredCaracteristicas)}}function Z(a,s){a&1&&(i(0,"c-alert",40),n(1,"Se agreg\xF3 al carrito de compras"),e())}function tt(a,s){if(a&1){let o=v();i(0,"button",41),C("click",function(){_(o);let t=u(2);return x(t.agregarACarrito())}),b(),g(1,"svg",42),n(2," A\xF1adir a carrito "),e()}}function et(a,s){if(a&1&&(i(0,"c-card",2)(1,"div",3)(2,"span",4),n(3,"Detalle"),e()(),i(4,"c-card-body")(5,"div",5)(6,"div",6)(7,"div",7)(8,"h5",8)(9,"span",9),n(10),e()(),i(11,"p",10)(12,"span",11),n(13),e()(),i(14,"div",12)(15,"label",13),n(16,"Cantidad: "),e(),i(17,"div")(18,"select",14)(19,"option",15),n(20,"1"),e(),i(21,"option",16),n(22,"2"),e(),i(23,"option",17),n(24,"3"),e(),i(25,"option",18),n(26,"4"),e(),i(27,"option",19),n(28,"5"),e(),i(29,"option",20),n(30,"6"),e(),i(31,"option",21),n(32,"7"),e(),i(33,"option",22),n(34,"8"),e(),i(35,"option",23),n(36,"9"),e(),i(37,"option",24),n(38,"10"),e()()()(),m(39,Y,2,1,"div",25),e(),g(40,"div",26),i(41,"div",27),g(42,"img",28),e()()(),i(43,"div",29)(44,"label",30),n(45,"Precio:"),e(),i(46,"p",31)(47,"span",11),n(48),e()()(),i(49,"div",32),m(50,Z,2,0,"c-alert",33)(51,tt,3,0,"button",34),e()()()),a&2){let o=u();l(10),f(o.producto.nombre),l(3),f(o.producto.descripcion),l(5),d("formControl",o.cantidad),l(21),d("ngIf",o.producto&&o.producto.caracteristicas&&o.producto.caracteristicas.length>0),l(3),d("src",o.producto.imagen,O),l(6),P("Q",o.functionUtils.formatPrice(o.producto.precio),""),l(2),d("ngIf",o.agregado),l(),d("ngIf",!o.agregado)}}var St=(()=>{let s=class s{constructor(r,t,c,h){this.service=r,this.functionUtils=t,this.route=c,this.titleService=h,this.mapaProductos={},this.caracteristicasSeleccionadas={},this.filteredCaracteristicas=[],this.agregado=!1}ngOnInit(){this.route.queryParams.subscribe(r=>{this.idProduct=r.idProduct}),this.cargarDatos(),this.cargarMapaDesdeLocalStorage(),this.service.mostrarSpinner=!1}cargarDatos(){this.producto=null,this.cantidad=new B("1",N.required),this.service.getAllItemsFromEntity("caracteristicas").subscribe(t=>{this.listaCaracteristicas=t},t=>{console.error(t)});let r=new K(new H(this.idProduct,"Prueba",null,null,null,null,null,null,null,null),null,null);this.service.getFromEntityAndMethod("productos","getById",r).subscribe(t=>{this.producto=t,this.filteredCaracteristicas=this.filtrarCaracteristicasAsociadas(),this.titleService.setTitle("Holandesa - "+this.producto.nombre),this.producto.imagen="data:image/jpeg;base64,"+this.producto.imagen},t=>{console.error(t)})}getValoresPorIdCaracteristica(r){let t=this.producto.caracteristicas.filter(c=>c.caracteristica.id===r.id).map(c=>c.valor);return t&&this.onSeleccionarValorCaracteristica(r.nombre,null,t[0]),t}filtrarCaracteristicasAsociadas(){let r=this.producto.caracteristicas.map(c=>c.caracteristica.id),t=this.listaCaracteristicas.filter(c=>r.includes(c.id));return t.forEach(c=>{c.listaValores=this.getValoresPorIdCaracteristica(c)}),t}agregarACarrito(){this.agregado=!0,this.mapaProductos[this.producto.id]?this.mapaProductos[this.producto.id].cantidad+=Number(this.cantidad.value):this.mapaProductos[this.producto.id]={producto:this.producto,cantidad:Number(this.cantidad.value),caracteristicas:this.caracteristicasSeleccionadas},this.guardarMapaEnLocalStorage()}guardarMapaEnLocalStorage(){localStorage.setItem("mapaProductos",JSON.stringify(this.mapaProductos)),this.cargarMapaDesdeLocalStorage()}cargarMapaDesdeLocalStorage(){let r=localStorage.getItem("mapaProductos");if(r){this.mapaProductos=JSON.parse(r);let t=Object.keys(this.mapaProductos).length;this.service.cantidadProductosCarrito=t}}onSeleccionarValorCaracteristica(r,t,c){t==null?this.caracteristicasSeleccionadas[r]=c:this.caracteristicasSeleccionadas[r]=t.target.value}};s.\u0275fac=function(t){return new(t||s)(p(G),p(J),p(D),p(I))},s.\u0275cmp=S({type:s,selectors:[["app-detalle-producto"]],standalone:!0,features:[w],decls:2,vars:1,consts:[[1,"d-flex","justify-content-center","flex-column","align-items-center"],["class","my-5 ancho-personalizado",4,"ngIf"],[1,"my-5","ancho-personalizado"],[1,"d-flex","justify-content-center","mt-3"],[1,"tittle"],[1,"container","mt-2"],[1,"row"],[1,"col-md-5"],[1,"mb-2","text-center"],[1,"justify-text","fw-bold","card-title-custom"],[1,"mb-0","text-center"],[1,"justify-text","card-description-custom"],[1,"col-auto","mt-3"],[1,"card-description-custom","fw-semibold","m-1"],[1,"form-select","m-1",3,"formControl"],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],["value","6"],["value","7"],["value","8"],["value","9"],["value","10"],[4,"ngIf"],[1,"col-md-1"],[1,"col-md-6","d-flex","justify-content-center"],["cCardImg","top",1,"fixed-size-img",3,"src"],[1,"col-auto","mt-4","d-flex","justify-content-center","w-100"],[1,"card-description-custom","fw-semibold",2,"margin-right","5px"],[1,"text-center"],[1,"justify-content-center","d-flex","mt-2",2,"padding-bottom","20px"],["color","success",4,"ngIf"],["cButton","","color","primary",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"col-md-auto"],[1,"form-select","m-1",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["color","success"],["cButton","","color","primary",3,"click"],["cIcon","","size","lg","name","cilCart",1,"me-2"]],template:function(t,c){t&1&&(i(0,"div",0),m(1,et,52,8,"c-card",1),e()),t&2&&(l(),d("ngIf",c.producto))},dependencies:[T,A,j,Q,E,y,z,$,q,R,U,k,L,F,V],styles:['@charset "UTF-8";button[_ngcontent-%COMP%]    {background-color:#00b3ba!important;border-color:#00b3ba!important}.ancho-personalizado[_ngcontent-%COMP%]{width:50%}.fixed-size-img[_ngcontent-%COMP%]{width:25vw;height:25vh;border-color:#0000001a;box-shadow:0 0 6px #0003;border-radius:5px}.justify-text[_ngcontent-%COMP%]{text-align:justify;display:inline-block;width:100%}.text-center[_ngcontent-%COMP%]{text-align:center}@media (min-width: 1351px){.ancho-personalizado[_ngcontent-%COMP%]{width:50%}.fixed-size-img[_ngcontent-%COMP%]{width:23vw;height:30vh}.tittle[_ngcontent-%COMP%]{color:#0009;font-size:25px}.card-title-custom[_ngcontent-%COMP%]{font-size:17px}.card-description-custom[_ngcontent-%COMP%]{font-size:16px}}@media (max-width: 1350px){.ancho-personalizado[_ngcontent-%COMP%]{width:55%}.fixed-size-img[_ngcontent-%COMP%]{width:26vw;height:29vh}.tittle[_ngcontent-%COMP%]{color:#0009;font-size:25px}.card-title-custom[_ngcontent-%COMP%]{font-size:17px}.card-description-custom[_ngcontent-%COMP%]{font-size:16px}}@media (max-width: 992px){.ancho-personalizado[_ngcontent-%COMP%]{width:75%}.fixed-size-img[_ngcontent-%COMP%]{width:30vw;height:28vh}.tittle[_ngcontent-%COMP%]{color:#0009;font-size:24px}.card-title-custom[_ngcontent-%COMP%]{font-size:16px}.card-description-custom[_ngcontent-%COMP%]{font-size:15px}}@media (max-width: 768px){.ancho-personalizado[_ngcontent-%COMP%]{width:80%}.fixed-size-img[_ngcontent-%COMP%]{width:32vw;height:28vh}.tittle[_ngcontent-%COMP%]{color:#0009;font-size:22px}.card-title-custom[_ngcontent-%COMP%]{font-size:14px}.card-description-custom[_ngcontent-%COMP%]{font-size:13px}}@media (max-width: 576px){.ancho-personalizado[_ngcontent-%COMP%]{width:90%}.fixed-size-img[_ngcontent-%COMP%]{width:38vw;height:26vh}.tittle[_ngcontent-%COMP%]{color:#0009;font-size:23px}.card-title-custom[_ngcontent-%COMP%]{font-size:15px}.card-description-custom[_ngcontent-%COMP%]{font-size:14px}}']});let a=s;return a})();export{St as DetalleProductoComponent};
