import{a as W,b as Y}from"./chunk-VXC2LIA7.js";import{b as X}from"./chunk-XCA2LUE2.js";import{b as U,c as L,f as $,h as q,k as J,l as R,m as Q,o as G}from"./chunk-3N7NB6A4.js";import{a as H}from"./chunk-4L43VRKW.js";import{a as K}from"./chunk-QEZJXKC3.js";import{C as A,F as N,H as B,I as k,c as j,e as V,q as T}from"./chunk-JTIIEVEG.js";import{Ab as S,Ac as I,Bc as D,Eb as b,Ec as F,Gb as f,Jb as E,Oa as y,Qb as r,Rb as x,Sa as s,Sb as v,Ta as h,Xb as z,aa as w,jb as g,la as C,ma as P,mb as d,na as M,ub as i,vb as e,wb as _}from"./chunk-AL5TOAVB.js";import"./chunk-Z6EQZUNN.js";function Z(c,l){if(c&1&&(i(0,"option",43),r(1),e()),c&2){let n=l.$implicit;E("value",n),s(),x(n)}}function tt(c,l){if(c&1){let n=S();i(0,"div")(1,"div",37)(2,"label",13),r(3),e(),i(4,"div",38)(5,"select",39),b("change",function(t){let a=C(n).$implicit,p=f(3);return P(p.onSeleccionarValorCaracteristica(p.producto,a,t,null))}),i(6,"option",40),r(7,"--Seleccionar--"),e(),g(8,Z,2,2,"option",41),e()(),i(9,"div",42)(10,"span"),r(11),e()()()()}if(c&2){let n=l.$implicit,o=f(3);s(3),v("",n.nombre,": "),s(5),d("ngForOf",n.listaValores),s(3),v("Q",o.functionUtils.formatPrice(n.precio),"")}}function et(c,l){if(c&1&&(i(0,"div"),g(1,tt,12,3,"div",36),e()),c&2){let n=f(2);s(),d("ngForOf",n.filteredCaracteristicas)}}function it(c,l){c&1&&(i(0,"c-alert",44),r(1,"Se agreg\xF3 al carrito de compras"),e())}function ot(c,l){if(c&1){let n=S();i(0,"button",45),b("click",function(){C(n);let t=f(2);return P(t.agregarACarrito())}),M(),_(1,"svg",46),r(2," A\xF1adir a carrito "),e()}}function nt(c,l){if(c&1&&(i(0,"c-card",2)(1,"div",3)(2,"span",4),r(3,"Detalle"),e()(),i(4,"c-card-body")(5,"div",5)(6,"div",6)(7,"div",7)(8,"h5",8)(9,"span",9),r(10),e()(),i(11,"p",10)(12,"span",11),r(13),e()(),i(14,"div",12)(15,"label",13),r(16,"Cantidad: "),e(),i(17,"div",14)(18,"select",15)(19,"option",16),r(20,"1"),e(),i(21,"option",17),r(22,"2"),e(),i(23,"option",18),r(24,"3"),e(),i(25,"option",19),r(26,"4"),e(),i(27,"option",20),r(28,"5"),e(),i(29,"option",21),r(30,"6"),e(),i(31,"option",22),r(32,"7"),e(),i(33,"option",23),r(34,"8"),e(),i(35,"option",24),r(36,"9"),e(),i(37,"option",25),r(38,"10"),e()()()(),g(39,et,2,1,"div",26),e(),_(40,"div",27),i(41,"div",28),_(42,"img",29),e()()(),i(43,"div",30)(44,"label",31),r(45,"Precio:"),e(),i(46,"p",32)(47,"span",11),r(48),e()()(),i(49,"div",33),g(50,it,2,0,"c-alert",34)(51,ot,3,0,"button",35),e()()()),c&2){let n=f();s(10),x(n.producto.nombre),s(3),x(n.producto.descripcion),s(5),d("formControl",n.cantidad),s(21),d("ngIf",n.producto&&n.producto.caracteristicas&&n.producto.caracteristicas.length>0),s(3),d("src",n.producto.imagen,y),s(6),v("Q",n.functionUtils.formatPrice(n.producto.precio),""),s(2),d("ngIf",n.agregado),s(),d("ngIf",!n.agregado)}}var wt=(()=>{let l=class l{constructor(o,t,a,p){this.service=o,this.functionUtils=t,this.route=a,this.titleService=p,this.mapaProductos={},this.caracteristicasSeleccionadas={},this.preciosSeleccionados={},this.filteredCaracteristicas=[],this.agregado=!1}ngOnInit(){this.service.isDashboardUrl=!1,this.route.queryParams.subscribe(o=>{this.idProduct=o.idProduct}),this.cargarDatos(),this.cargarMapaDesdeLocalStorage(),this.service.mostrarSpinner=!1}cargarDatos(){this.producto=null,this.cantidad=new $("1",U.required),this.service.getAllItemsFromEntity("caracteristicas").subscribe(t=>{this.listaCaracteristicas=t},t=>{console.error(t)});let o=new Y(new W(this.idProduct,"Prueba",null,null,null,null,null,null,null,null),null,null);this.service.getFromEntityAndMethod("productos","getById",o).subscribe(t=>{this.producto=t,this.precioBase=this.producto.precio,this.filteredCaracteristicas=this.filtrarCaracteristicasAsociadas(),this.titleService.setTitle("Holandesa - "+this.producto.nombre),this.producto.imagen="data:image/jpeg;base64,"+this.producto.imagen},t=>{console.error(t)})}getValoresPorIdCaracteristica(o){let t=this.producto.caracteristicas.filter(a=>a.caracteristica.id===o.id).map(a=>a.valor);return t&&this.onSeleccionarValorCaracteristica(this.producto,o,null,null),t}filtrarCaracteristicasAsociadas(){let o=this.producto.caracteristicas.map(a=>a.caracteristica.id),t=this.listaCaracteristicas.filter(a=>o.includes(a.id));return t.forEach(a=>{a.listaValores=this.getValoresPorIdCaracteristica(a)}),t}agregarACarrito(){this.agregado=!0;let o=this.producto.id+JSON.stringify(this.caracteristicasSeleccionadas);this.mapaProductos[o]?this.mapaProductos[o].cantidad+=Number(this.cantidad.value):this.mapaProductos[o]={producto:this.producto,cantidad:Number(this.cantidad.value),caracteristicas:this.caracteristicasSeleccionadas},this.guardarMapaEnLocalStorage()}guardarMapaEnLocalStorage(){localStorage.setItem("mapaProductos",JSON.stringify(this.mapaProductos)),this.cargarMapaDesdeLocalStorage()}cargarMapaDesdeLocalStorage(){let o=localStorage.getItem("mapaProductos");if(o){this.mapaProductos=JSON.parse(o);let t=Object.keys(this.mapaProductos).length;this.service.cantidadProductosCarrito=t}}onSeleccionarValorCaracteristica(o,t,a,p){let m=null;a==null?(m=o.caracteristicas.find(u=>u.valor===p),t.precio=m&&m.precio?m.precio:0,this.caracteristicasSeleccionadas[t.nombre]=p,this.preciosSeleccionados[t.nombre]=t?t.precio:0):(m=o.caracteristicas.find(u=>u.valor===a.target.value),t.precio=m&&m.precio?m.precio:0,this.caracteristicasSeleccionadas[t.nombre]=a.target.value,this.preciosSeleccionados[t.nombre]=t?t.precio:0),this.producto.precio=this.precioBase;for(let u in this.preciosSeleccionados)if(this.preciosSeleccionados.hasOwnProperty(u)){let O=this.preciosSeleccionados[u];console.log(`Producto: ${u}, Precio: ${O}`),this.producto.precio+=O}}};l.\u0275fac=function(t){return new(t||l)(h(K),h(H),h(V),h(j))},l.\u0275cmp=w({type:l,selectors:[["app-detalle-producto"]],standalone:!0,features:[z],decls:2,vars:1,consts:[[1,"d-flex","justify-content-center","flex-column","align-items-center"],["class","my-5 ancho-personalizado",4,"ngIf"],[1,"my-5","ancho-personalizado"],[1,"d-flex","justify-content-center","mt-3"],[1,"tittle"],[1,"container","mt-2"],[1,"row"],[1,"col-md-5"],[1,"mb-2","text-center"],[1,"justify-text","fw-bold","card-title-custom"],[1,"mb-0","text-center"],[1,"justify-text","card-description-custom"],[1,"col-auto","mt-3"],[1,"card-description-custom","fw-semibold","m-1"],[1,"col-8"],[1,"form-select","m-1",3,"formControl"],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],["value","6"],["value","7"],["value","8"],["value","9"],["value","10"],[4,"ngIf"],[1,"col-md-1"],[1,"col-md-6","d-flex","justify-content-center"],["cCardImg","top",1,"fixed-size-img",3,"src"],[1,"col-auto","mt-4","d-flex","justify-content-center","w-100"],[1,"card-description-custom","fw-semibold",2,"margin-right","5px"],[1,"text-center"],[1,"justify-content-center","d-flex","mt-2",2,"padding-bottom","20px"],["color","success",4,"ngIf"],["cButton","","color","primary",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"col-12","mt-3","row"],[1,"col-9"],[1,"form-select","m-1",3,"change"],["value","null"],[3,"value",4,"ngFor","ngForOf"],[1,"col-3"],[3,"value"],["color","success"],["cButton","","color","primary",3,"click"],["cIcon","","size","lg","name","cilCart",1,"me-2"]],template:function(t,a){t&1&&(i(0,"div",0),g(1,nt,52,8,"c-card",1),e()),t&2&&(s(),d("ngIf",a.producto))},dependencies:[B,k,A,X,F,I,D,G,R,Q,J,L,q,T,N],styles:['@charset "UTF-8";button[_ngcontent-%COMP%]    {background-color:#00b3ba!important;border-color:#00b3ba!important}.ancho-personalizado[_ngcontent-%COMP%]{width:50%}.fixed-size-img[_ngcontent-%COMP%]{width:25vw;height:25vh;border-color:#0000001a;box-shadow:0 0 6px #0003;border-radius:5px}.justify-text[_ngcontent-%COMP%]{text-align:justify;display:inline-block;width:100%}.text-center[_ngcontent-%COMP%]{text-align:center}@media (min-width: 1351px){.ancho-personalizado[_ngcontent-%COMP%]{width:50%}.fixed-size-img[_ngcontent-%COMP%]{width:23vw;height:30vh}.tittle[_ngcontent-%COMP%]{color:#0009;font-size:25px}.card-title-custom[_ngcontent-%COMP%]{font-size:17px}.card-description-custom[_ngcontent-%COMP%]{font-size:16px}}@media (max-width: 1350px){.ancho-personalizado[_ngcontent-%COMP%]{width:55%}.fixed-size-img[_ngcontent-%COMP%]{width:26vw;height:29vh}.tittle[_ngcontent-%COMP%]{color:#0009;font-size:25px}.card-title-custom[_ngcontent-%COMP%]{font-size:17px}.card-description-custom[_ngcontent-%COMP%]{font-size:16px}}@media (max-width: 992px){.ancho-personalizado[_ngcontent-%COMP%]{width:75%}.fixed-size-img[_ngcontent-%COMP%]{width:35vw;height:26vh}.tittle[_ngcontent-%COMP%]{color:#0009;font-size:24px}.card-title-custom[_ngcontent-%COMP%]{font-size:16px}.card-description-custom[_ngcontent-%COMP%]{font-size:15px}}@media (max-width: 768px){.ancho-personalizado[_ngcontent-%COMP%]{width:80%}.fixed-size-img[_ngcontent-%COMP%]{width:50vw;height:25vh}.tittle[_ngcontent-%COMP%]{color:#0009;font-size:22px}.card-title-custom[_ngcontent-%COMP%]{font-size:14px}.card-description-custom[_ngcontent-%COMP%]{font-size:13px}}@media (max-width: 576px){.ancho-personalizado[_ngcontent-%COMP%]{width:90%}.fixed-size-img[_ngcontent-%COMP%]{width:65vw;height:27vh}.tittle[_ngcontent-%COMP%]{color:#0009;font-size:23px}.card-title-custom[_ngcontent-%COMP%]{font-size:15px}.card-description-custom[_ngcontent-%COMP%]{font-size:14px}}']});let c=l;return c})();export{wt as DetalleProductoComponent};
